\section{Databasehåndtering}
\label{sec:database}

I dette projekt benyttes Entity Framework, som er Microsofts anbefalede teknologi til at tilgå data.

\subsection{Code First}
\label{sub:code_first}


Med Entity Framework kan man først skrive sin model som en C\# klasse, kaldt \enquote{Code First}, og derefter kan man bruge frameworket til at gemme disse klasser i en database. Entity Framework kan ud fra felterne i den modellerede klasse selv oprette de nødvendige kolonner i databasen. Entity Framework er altså en abstraktion for tilgangen til en underliggende database. Dermed kan brugeren af Enity Framework nøjes med at bekymre sig om programmeringen af modellen der skal gemmes.

\subsection{Annoteringer}
\label{sub:annoteringer}

Selvom Entity Framework kan gøre mange ting automatisk, skal brugeren af frameworket angive forskellige informationer. Når Entity Framework skal lave database tabeller, skal det vide hvilket felt i C\# klassen der skal være \enquote{Primary Key}. En primary key (PK) er et unikt indeks til databasen, så den kan identificere de forskellige elementer i tabellen. Et felt i en klasse angives som PK ved at kalde feltnavnet for \enquote{<klassenavn>Id}. Denne konvention kan dog udelades, hvis bare feltet annoteres med \enquote{[Key]}.

\subsection{Migreringer}
\label{sub:migreringer}

Migreringer skal benyttes når man gerne vil flytte data fra én database til en anden. En sådan situation kan opstå hvis en eksisterende database mangler en bestemt kolonne, f.eks. antal æbler. Denne database har været i brug, og indeholder derfor vigtig information, som ikke må gå tabt. Opgaven er nu at flytte den vigtige information fra den eksisterende database til en ny database der har den ønskede antal æbler kolonne.

Dette foregår i Entity Framework ved hjælp af Package Manager Console i Visual Studio. Først skal man fortælle Entity Framework at den skal slå migrationer til. Dette gøres ved at skrive \enquote{Enable-Migrations} i Package Manager Console.

Nu kan man lave en ændring i en model, i dette tilfælde tilføje et felt holder informationer om antallet af æbler. I Package Manager Console skrives nu \enquote{Add-Migration <migrations tekst>}, hvor migrations tekst er en beskrivende tekst til migrationen. Entity Framework klarer nu arbjedet med at udregne hvilke ændringer der skal foretages når der skal opgraderes til denne nyligt kreerede migration, samt hvad der skal ske hvis der skal nedgraderes fra denne migration.

For at anvende den nye migration, skrives \enquote{Update-Database} i Package Manager Console.
